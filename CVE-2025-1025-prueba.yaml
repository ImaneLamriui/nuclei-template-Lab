id: CVE-2025-1025-prueba
info:
  name: CVE-2025-1025 - prueba (non-exec upload verification)
  author: reconstructed-by-chatgpt
  severity: medium
  description: "prueba safe template: simula flujo login -> upload (archivo de texto con marker) -> verificaci√≥n."
  tags: [cve, cockpit, file-upload, prueba, non-intrusive]
flow: http(1) && http(2) && http(3)
variables:
  username: "prueba"
  password: "prueba"
  marker: "{{randstr_1}}"
http:
  - raw:
      - |
        GET /auth/login HTTP/1.1
        Host: {{Hostname}}
      - |
        POST /auth/check HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/json; charset=UTF-8

        {"auth":{"user":"{{username}}","password":"{{password}}"},"csrf":"{{csrf}}"}
    matchers:
      - type: word
        part: body
        words:
          - 'success":true'
          - '"role":'
        condition: and
        internal: true
    extractors:
      - type: regex
        name: csrf
        group: 1
        part: body
        regex:
          - 'csrf : "(.*?)"'
        internal: true

  - raw:
      - |
        POST /assets/upload HTTP/1.1
        Host: {{Hostname}}
        Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryDemo

        ------WebKitFormBoundaryDemo
        Content-Disposition: form-data; name="folder"


        ------WebKitFormBoundaryDemo
        Content-Disposition: form-data; name="files[]"; filename="{{randstr}}.txt"
        Content-Type: text/plain

        {{marker}}
        ------WebKitFormBoundaryDemo--
    matchers:
      - type: word
        part: body
        words:
          - '"uploaded":["{{randstr}}.txt"]'
        internal: true
    extractors:
      - type: json
        name: upload_path
        part: body
        json:
          - '.assets[0].path'
        internal: true

  - raw:
      - |
        GET /storage/uploads/{{upload_path}} HTTP/1.1
        Host: {{Hostname}}
    matchers:
      - type: status
        part: header
        status:
          - 200
      - type: word
        part: body
        words:
          - '{{marker}}'
